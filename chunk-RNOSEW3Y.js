import{a as z,b as L,c as m,d as B,e as Q,f as G,g as R,h as W,i as Y,j as H,k as J,l as K,m as X,n as Z,o as ee,p as te,q as ne}from"./chunk-TMDLGDPT.js";import{a as $,b as U}from"./chunk-SM6POI6B.js";import{w as N}from"./chunk-ZCTLOLTJ.js";import{$a as x,Ab as S,Bb as g,Db as A,Ea as r,Eb as k,Fb as F,Ja as j,Lb as V,Na as T,Nb as q,_a as h,ab as y,bb as M,cb as w,db as C,eb as i,fb as n,gb as _,gc as D,ic as I,ja as p,ka as b,mb as v,nb as u,pb as d,xb as P,zb as o}from"./chunk-PT7SL42D.js";import{a as O,b as E}from"./chunk-WTI2L5DI.js";function oe(s,t){if(s&1){let e=v();i(0,"div",28),u("click",function(){let a=p(e).$implicit,l=d(2);return b(l.selectSection(a))}),i(1,"div",29)(2,"h3"),o(3),n(),i(4,"p"),o(5),n(),i(6,"div",30)(7,"span",31),o(8),n(),i(9,"span",32),o(10),n(),i(11,"span",33),o(12),n()()(),i(13,"div",34)(14,"button",35),u("click",function(a){let l=p(e).$implicit;return d(2).toggleSectionPublished(l),b(a.stopPropagation())}),i(15,"span",36),o(16),n()(),i(17,"button",37),u("click",function(a){let l=p(e).$implicit;return d(2).deleteSection(l),b(a.stopPropagation())}),i(18,"span",36),o(19,"\u{1F5D1}\uFE0F"),n()(),i(20,"button",38),u("click",function(a){let l=p(e).$index;return d(2).moveSection(l,l-1),b(a.stopPropagation())}),i(21,"span",36),o(22,"\u2B06\uFE0F"),n()(),i(23,"button",39),u("click",function(a){let l=p(e).$index;return d(2).moveSection(l,l+1),b(a.stopPropagation())}),i(24,"span",36),o(25,"\u2B07\uFE0F"),n()()()()}if(s&2){let e=t.$implicit,c=t.$index,a=d(2);P("selected",(a.selectedSection==null?null:a.selectedSection.id)===e.id),r(3),S(e.title),r(2),S(e.description),r(3),g("Order: ",e.order),r(),P("published",e.isPublished),r(),g(" ",e.isPublished?"Published":"Draft"," "),r(2),g("",e.subjects.length||0," subjects"),r(4),S(e.isPublished?"\u{1F441}\uFE0F":"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F"),r(4),C("disabled",c===0),r(3),C("disabled",c===a.sections.length-1)}}function re(s,t){s&1&&(i(0,"div",27),o(1," No sections created yet. Create your first section above. "),n())}function ce(s,t){if(s&1){let e=v();i(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"h2"),o(5,"Create New Section"),n()(),i(6,"div",9)(7,"form",10),u("ngSubmit",function(){p(e);let a=d();return b(a.createSection())}),i(8,"div",11)(9,"label",12),o(10,"Section Title"),n(),_(11,"input",13),n(),i(12,"div",11)(13,"label",14),o(14,"Description"),n(),_(15,"textarea",15),n(),i(16,"div",11)(17,"label",16),o(18,"Order"),n(),_(19,"input",17),n(),i(20,"div",18)(21,"label",19),_(22,"input",20)(23,"span",21),o(24," Published "),n()(),i(25,"div",22)(26,"button",23),o(27," Create Section "),n()()()()(),i(28,"div",24)(29,"div",8)(30,"h2"),o(31,"Existing Sections"),n()(),i(32,"div",9)(33,"div",25),M(34,oe,26,12,"div",26,y),n(),h(36,re,2,0,"div",27),n()()()()}if(s&2){let e=d();r(7),C("formGroup",e.sectionForm),r(19),C("disabled",!e.sectionForm.valid),r(8),w(e.sections),r(2),x(e.sections.length===0?36:-1)}}function ae(s,t){if(s&1){let e=v();i(0,"div",53),u("click",function(){let a=p(e).$implicit,l=d(2);return b(l.selectSubject(a))}),i(1,"div",54)(2,"h3"),o(3),n(),i(4,"p"),o(5),n(),i(6,"div",55)(7,"span",31),o(8),n(),i(9,"span",31),o(10),n(),i(11,"span",56),o(12),n()()(),i(13,"div",57)(14,"button",58),u("click",function(a){let l=p(e).$implicit;return d(2).deleteSubject(l),b(a.stopPropagation())}),i(15,"span",36),o(16,"\u{1F5D1}\uFE0F"),n()(),i(17,"button",38),u("click",function(a){let l=p(e).$index;return d(2).moveSubject(l,l-1),b(a.stopPropagation())}),i(18,"span",36),o(19,"\u2B06\uFE0F"),n()(),i(20,"button",39),u("click",function(a){let l=p(e).$index;return d(2).moveSubject(l,l+1),b(a.stopPropagation())}),i(21,"span",36),o(22,"\u2B07\uFE0F"),n()()()()}if(s&2){let e=t.$implicit,c=t.$index,a=d(2);P("selected",(a.selectedSubject==null?null:a.selectedSubject.id)===e.id),r(3),S(e.title),r(2),S(e.description),r(3),g("Order: ",e.order),r(2),g("Min Points: ",e.minPointsRequired||0),r(2),g("",e.contents.length||0," contents"),r(5),C("disabled",c===0),r(3),C("disabled",c===(a.selectedSection.subjects.length||0)-1)}}function se(s,t){s&1&&(i(0,"div",27),o(1," No subjects created yet. Create your first subject above. "),n())}function le(s,t){if(s&1){let e=v();i(0,"div",5)(1,"div",40)(2,"div",41)(3,"h2"),o(4),n()(),i(5,"div",7)(6,"div",8)(7,"h2"),o(8,"Create New Subject"),n()(),i(9,"div",9)(10,"form",10),u("ngSubmit",function(){p(e);let a=d();return b(a.createSubject())}),i(11,"div",11)(12,"label",42),o(13,"Subject Title"),n(),_(14,"input",43),n(),i(15,"div",11)(16,"label",44),o(17,"Description"),n(),_(18,"textarea",45),n(),i(19,"div",11)(20,"label",46),o(21,"Order"),n(),_(22,"input",47),n(),i(23,"div",11)(24,"label",48),o(25,"Minimum Points Required"),n(),_(26,"input",49),n(),i(27,"div",22)(28,"button",23),o(29," Create Subject "),n()()()()(),i(30,"div",50)(31,"div",8)(32,"h2"),o(33),n()(),i(34,"div",9)(35,"div",51),M(36,ae,23,9,"div",52,y),n(),h(38,se,2,0,"div",27),n()()()()}if(s&2){let e=d();r(4),g("Managing subjects for: ",e.selectedSection.title),r(6),C("formGroup",e.subjectForm),r(18),C("disabled",!e.subjectForm.valid),r(5),g("Subjects in ",e.selectedSection.title),r(3),w(e.selectedSection.subjects),r(2),x(!e.selectedSection.subjects||e.selectedSection.subjects.length===0?38:-1)}}function de(s,t){if(s&1&&(i(0,"option",64),o(1),n()),s&2){let e=t.$implicit;C("value",e.value),r(),g(" ",e.label," ")}}function me(s,t){s&1&&(i(0,"div")(1,"div",11)(2,"label",70),o(3,"Title"),n(),_(4,"input",71),n(),i(5,"div",11)(6,"label",72),o(7,"Content"),n(),_(8,"textarea",73),n()())}function ue(s,t){if(s&1){let e=v();i(0,"div",83)(1,"div",11)(2,"label",87),o(3),n(),_(4,"input",88),n(),i(5,"button",89),u("click",function(){let a=p(e).$index,l=d(3);return b(l.removeOption(a))}),i(6,"span",36),o(7,"\u274C"),n()()()}if(s&2){let e=t.$implicit,c=t.$index,a=d(3);r(2),C("for","option"+c),r(),g("Option ",c+1),r(),C("id","option"+c)("formControl",e),r(),C("disabled",a.optionsArray.length<=2)}}function pe(s,t){if(s&1&&(i(0,"option",64),o(1),n()),s&2){let e=t.$index;C("value",e),r(),g(" Option ",e+1," ")}}function be(s,t){if(s&1){let e=v();i(0,"div")(1,"div",11)(2,"label",74),o(3,"Title"),n(),_(4,"input",75),n(),i(5,"div",11)(6,"label",76),o(7,"Question"),n(),_(8,"textarea",77),n(),i(9,"div",11)(10,"label",78),o(11,"Time Limit (seconds)"),n(),_(12,"input",79),n(),i(13,"div",11)(14,"label",80),o(15,"Max Points"),n(),_(16,"input",81),n(),i(17,"div",82)(18,"h4"),o(19,"Options"),n(),M(20,ue,8,5,"div",83,y),i(22,"button",84),u("click",function(){p(e);let a=d(2);return b(a.addOption())}),o(23," \u2795 Add Option "),n()(),i(24,"div",11)(25,"label",85),o(26,"Correct Answer"),n(),i(27,"select",86),M(28,pe,2,2,"option",64,y),n()()()}if(s&2){let e=d(2);r(20),w(e.optionsArray.controls),r(8),w(e.optionsArray.controls)}}function _e(s,t){s&1&&(i(0,"div")(1,"div",11)(2,"label",90),o(3,"Title"),n(),_(4,"input",91),n(),i(5,"div",11)(6,"label",92),o(7,"Question"),n(),_(8,"textarea",93),n(),i(9,"div",11)(10,"label",94),o(11,"Time Limit (seconds)"),n(),_(12,"input",95),n(),i(13,"div",11)(14,"label",96),o(15,"Max Points"),n(),_(16,"input",97),n(),i(17,"div",11)(18,"label",98),o(19,"Correct Answer"),n(),i(20,"select",99)(21,"option",64),o(22,"True"),n(),i(23,"option",64),o(24,"False"),n()()()()),s&2&&(r(21),C("value",!0),r(2),C("value",!1))}function Ce(s,t){if(s&1){let e=v();i(0,"button",84),u("click",function(){p(e);let a=d(2);return b(a.resetContentForm())}),o(1," Cancel "),n()}}function ge(s,t){if(s&1){let e=v();i(0,"div",101)(1,"div",102)(2,"span",103),o(3),n(),i(4,"h4"),o(5),n(),i(6,"span",104),o(7),n()(),i(8,"div",105)(9,"button",106),u("click",function(a){let l=p(e).$implicit,f=d(3);return f.startEditContent(l),f.setActiveTab("content"),b(a.stopPropagation())}),i(10,"span",36),o(11,"\u270F\uFE0F"),n()(),i(12,"button",107),u("click",function(a){let l=p(e).$implicit;return d(3).deleteContent(l),b(a.stopPropagation())}),i(13,"span",36),o(14,"\u{1F5D1}\uFE0F"),n()()()()}if(s&2){let e=t.$implicit,c=d(3);r(3),S(c.getContentTypeLabel(e)),r(2),S(c.getContentPreview(e)),r(2),g("Order: ",e.order)}}function he(s,t){if(s&1&&(i(0,"div",69)(1,"div",8)(2,"h2"),o(3,"Existing Content"),n()(),i(4,"div",9)(5,"div",100),M(6,ge,15,3,"div",101,y),n()()()),s&2){let e=d(2);r(6),w(e.selectedSubject.contents)}}function xe(s,t){if(s&1){let e=v();i(0,"div",5)(1,"div",59)(2,"div",60)(3,"h2"),o(4),n(),i(5,"p"),o(6),n(),i(7,"p")(8,"strong"),o(9,"Total Max Points in Subject:"),n(),o(10),n()(),i(11,"div",61)(12,"div",8)(13,"h2"),o(14),n()(),i(15,"div",9)(16,"div",11)(17,"label",62),o(18,"Content Type"),n(),i(19,"select",63),F("ngModelChange",function(a){p(e);let l=d();return k(l.selectedContentType,a)||(l.selectedContentType=a),b(a)}),u("ngModelChange",function(){p(e);let a=d();return b(a.onContentTypeChange())}),M(20,de,2,2,"option",64,y),n()()()(),i(22,"div",65)(23,"div",9)(24,"form",10),u("ngSubmit",function(){p(e);let a=d();return b(a.createContent())}),h(25,me,9,0,"div"),h(26,be,30,0,"div"),h(27,_e,25,2,"div"),i(28,"div",11)(29,"label",66),o(30,"Order"),n(),_(31,"input",67),n(),i(32,"div",22)(33,"button",23),o(34),n(),h(35,Ce,2,0,"button",68),n()()()(),h(36,he,8,0,"div",69),n()()}if(s&2){let e=d();r(4),g("Managing content for: ",e.selectedSubject.title),r(2),g("Section: ",e.selectedSection==null?null:e.selectedSection.title),r(4),g(" ",e.getSubjectTotalPoints(e.selectedSubject)),r(4),g("",e.isEditingContent?"Edit":"Create"," Content"),r(5),A("ngModel",e.selectedContentType),r(),w(e.contentTypes),r(4),C("formGroup",e.contentForm),r(),x(e.selectedContentType==="theory"?25:-1),r(),x(e.selectedContentType==="mcq"?26:-1),r(),x(e.selectedContentType==="truefalse"?27:-1),r(6),C("disabled",!e.contentForm.valid),r(),g(" ",e.isEditingContent?"Update":"Create"," Content "),r(),x(e.isEditingContent?35:-1),r(),x(e.selectedSubject.contents&&e.selectedSubject.contents.length>0?36:-1)}}function fe(s,t){if(s&1){let e=v();i(0,"button",121),u("click",function(){p(e);let a=d().$implicit,l=d(2);return b(l.promoteToAdmin(a))}),o(1," Make Admin "),n()}}function ve(s,t){if(s&1){let e=v();i(0,"button",122),u("click",function(){p(e);let a=d().$implicit,l=d(2);return b(l.demoteFromAdmin(a))}),o(1," Remove Admin "),n()}}function Se(s,t){if(s&1&&(i(0,"tr",112)(1,"td",113),o(2),n(),i(3,"td",114),o(4),n(),i(5,"td",115),o(6),V(7,"date"),n(),i(8,"td",116)(9,"span",117),o(10),n()(),i(11,"td",118),h(12,fe,2,0,"button",119),h(13,ve,2,0,"button",120),n()()),s&2){let e=t.$implicit;r(2),S(e.displayName||"N/A"),r(2),S(e.email),r(2),S(q(7,10,e.createdAt,"short")),r(3),P("admin",e.isAdmin)("regular",!e.isAdmin),r(),g(" ",e.isAdmin?"Admin":"User"," "),r(2),x(e.isAdmin?-1:12),r(),x(e.isAdmin?13:-1)}}function Pe(s,t){s&1&&(i(0,"div",27),o(1," No users found. "),n())}function ye(s,t){if(s&1&&(i(0,"div",5)(1,"div",108)(2,"div",109)(3,"div",8)(4,"h2"),o(5,"User Management"),n()(),i(6,"div",9)(7,"div",110)(8,"table",111)(9,"thead")(10,"tr")(11,"th"),o(12,"Display Name"),n(),i(13,"th"),o(14,"Email"),n(),i(15,"th"),o(16,"Created"),n(),i(17,"th"),o(18,"Admin Status"),n(),i(19,"th"),o(20,"Actions"),n()()(),i(21,"tbody"),M(22,Se,14,13,"tr",112,y),n()(),h(24,Pe,2,0,"div",27),n()()()()()),s&2){let e=d();r(22),w(e.users),r(2),x(e.users.length===0?24:-1)}}var ie=class s{constructor(t,e,c,a){this.contentService=t;this.authService=e;this.userService=c;this.fb=a;this.initializeForms()}sections=[];selectedSection=null;selectedSubject=null;users=[];activeTab="sections";sectionForm;subjectForm;contentForm;contentTypes=[{value:"theory",label:"Theory"},{value:"mcq",label:"Multiple Choice Question"},{value:"truefalse",label:"True/False Question"}];selectedContentType="theory";isEditingContent=!1;editingContentId=null;totalSubjectPoints=0;ngOnInit(){this.loadSections(),this.loadUsers()}setActiveTab(t){this.activeTab=t,t==="users"&&this.loadUsers()}initializeForms(){this.sectionForm=this.fb.group({title:["",m.required],description:["",m.required],order:[0,m.required],isPublished:[!1]}),this.subjectForm=this.fb.group({title:["",m.required],description:["",m.required],order:[0,m.required],minPointsRequired:[0,[m.min(0)]]}),this.contentForm=this.fb.group({title:[""],content:[""],question:[""],options:this.fb.array([]),correctAnswer:[0],timeLimitSeconds:[null],maxPoints:[null],order:[0,m.required]})}get optionsArray(){return this.contentForm.get("options")}addOption(){this.optionsArray.push(this.fb.control("",m.required))}removeOption(t){if(this.optionsArray.length>2){this.optionsArray.removeAt(t);let e=this.contentForm.get("correctAnswer")?.value;typeof e=="number"&&e>=this.optionsArray.length&&this.contentForm.get("correctAnswer")?.setValue(this.optionsArray.length-1)}}loadSections(){this.contentService.getAllSections().subscribe({next:t=>{this.sections=t},error:t=>{this.showMessage("Error loading sections: "+t.message)}})}createSection(){if(this.sectionForm.valid){let t=E(O({},this.sectionForm.value),{subjects:[]});this.contentService.createSection(t).subscribe({next:e=>{this.showMessage("Section created successfully"),this.sectionForm.reset(),this.loadSections()},error:e=>{this.showMessage("Error creating section: "+e.message)}})}}selectSection(t){this.selectedSection=t,this.selectedSubject=null,this.loadSubjects(t.id)}loadSubjects(t){this.contentService.getSubjectsBySectionId(t).subscribe({next:e=>{this.selectedSection&&(this.selectedSection.subjects=e)},error:e=>{this.showMessage("Error loading subjects: "+e.message)}})}createSubject(){if(this.subjectForm.valid&&this.selectedSection){let t=E(O({},this.subjectForm.value),{contents:[]});this.contentService.createSubject(this.selectedSection.id,t).subscribe({next:e=>{this.showMessage("Subject created successfully"),this.subjectForm.reset(),this.loadSubjects(this.selectedSection.id)},error:e=>{this.showMessage("Error creating subject: "+e.message)}})}}selectSubject(t){this.selectedSubject=t,this.resetContentForm(),this.recomputeTotalPoints()}recomputeTotalPoints(){if(!this.selectedSubject?.contents){this.totalSubjectPoints=0;return}this.totalSubjectPoints=this.selectedSubject.contents.reduce((t,e)=>t+(typeof e.maxPoints=="number"?e.maxPoints:0),0)}getSubjectTotalPoints(t){return t?.contents?t.contents.reduce((e,c)=>e+(typeof c.maxPoints=="number"?c.maxPoints:0),0):0}onContentTypeChange(){this.resetContentForm(),this.setupContentFormForType()}resetContentForm(){this.contentForm.reset(),this.isEditingContent=!1,this.editingContentId=null,this.optionsArray.clear(),this.setupContentFormForType()}setupContentFormForType(){let t=this.contentForm;switch(Object.keys(t.controls).forEach(e=>{t.get(e)?.clearValidators()}),this.selectedContentType){case"theory":t.get("title")?.setValidators([m.required]),t.get("content")?.setValidators([m.required]);break;case"mcq":t.get("title")?.setValidators([m.required]),t.get("question")?.setValidators([m.required]),t.get("correctAnswer")?.setValidators([m.required]),t.get("timeLimitSeconds")?.setValidators([m.required,m.min(1)]),t.get("maxPoints")?.setValidators([m.required,m.min(1)]),!this.isEditingContent&&this.optionsArray.length===0&&(this.addOption(),this.addOption(),this.addOption(),this.addOption());break;case"truefalse":t.get("title")?.setValidators([m.required]),t.get("question")?.setValidators([m.required]),t.get("correctAnswer")?.setValidators([m.required]),t.get("timeLimitSeconds")?.setValidators([m.required,m.min(1)]),t.get("maxPoints")?.setValidators([m.required,m.min(1)]);break}Object.keys(t.controls).forEach(e=>{t.get(e)?.updateValueAndValidity()})}startEditContent(t){if(this.isEditingContent=!0,this.editingContentId=t.id||null,this.selectedContentType=t.type,this.contentForm.reset(),this.optionsArray.clear(),this.setupContentFormForType(),this.contentForm.patchValue({title:t.title??"",order:t.order??0}),t.type==="theory"){let e=t;this.contentForm.patchValue({content:e.content})}else if(t.type==="mcq"){let e=t;Array.isArray(e.options)&&e.options.forEach(c=>this.optionsArray.push(this.fb.control(c,m.required))),this.contentForm.patchValue({question:e.question,correctAnswer:e.correctAnswer,timeLimitSeconds:e.timeLimitSeconds??null,maxPoints:e.maxPoints??null})}else if(t.type==="truefalse"){let e=t;this.contentForm.patchValue({question:e.question,correctAnswer:e.correctAnswer,timeLimitSeconds:e.timeLimitSeconds??null,maxPoints:e.maxPoints??null})}}deleteContent(t){!this.selectedSection||!this.selectedSubject||!t?.id||confirm(`Delete content "${t.title||t.type}"?`)&&this.contentService.deleteSubjectContent(this.selectedSection.id,this.selectedSubject.id,t.id).subscribe({next:()=>{this.showMessage("Content deleted successfully"),this.loadSubjects(this.selectedSection.id),this.recomputeTotalPoints(),this.isEditingContent&&this.editingContentId===t.id&&this.resetContentForm()},error:e=>this.showMessage("Error deleting content: "+e.message)})}buildContentPayload(){let t=this.contentForm.value,e={order:t.order};switch(this.selectedContentType){case"theory":return E(O({},e),{title:t.title,type:"theory",content:t.content});case"mcq":return E(O({},e),{title:t.title,type:"mcq",question:t.question,options:t.options,correctAnswer:t.correctAnswer,timeLimitSeconds:t.timeLimitSeconds,maxPoints:t.maxPoints});case"truefalse":return E(O({},e),{title:t.title,type:"truefalse",question:t.question,correctAnswer:t.correctAnswer===!0,timeLimitSeconds:t.timeLimitSeconds,maxPoints:t.maxPoints})}return e}createContent(){if(this.contentForm.valid&&this.selectedSection&&this.selectedSubject){let t=this.buildContentPayload();if(this.isEditingContent&&this.editingContentId){this.contentService.updateSubjectContent(this.selectedSection.id,this.selectedSubject.id,this.editingContentId,t).subscribe({next:()=>{this.showMessage("Content updated successfully"),this.resetContentForm(),this.loadSubjects(this.selectedSection.id),this.recomputeTotalPoints()},error:e=>{this.showMessage("Error updating content: "+e.message)}});return}this.contentService.addContentToSubject(this.selectedSection.id,this.selectedSubject.id,t).subscribe({next:()=>{this.showMessage("Content created successfully"),this.resetContentForm(),this.loadSubjects(this.selectedSection.id),this.recomputeTotalPoints()},error:e=>{this.showMessage("Error creating content: "+e.message)}})}}deleteSection(t){confirm(`Are you sure you want to delete section "${t.title}"?`)&&this.contentService.deleteSection(t.id).subscribe({next:()=>{this.showMessage("Section deleted successfully"),this.loadSections(),this.selectedSection?.id===t.id&&(this.selectedSection=null,this.selectedSubject=null)},error:e=>{this.showMessage("Error deleting section: "+e.message)}})}deleteSubject(t){confirm(`Are you sure you want to delete subject "${t.title}"?`)&&this.selectedSection&&this.contentService.deleteSubject(this.selectedSection.id,t.id).subscribe({next:()=>{this.showMessage("Subject deleted successfully"),this.loadSubjects(this.selectedSection.id),this.selectedSubject?.id===t.id&&(this.selectedSubject=null)},error:e=>{this.showMessage("Error deleting subject: "+e.message)}})}toggleSectionPublished(t){let e=t.isPublished?"unpublish":"publish";(t.isPublished?this.contentService.unpublishSection(t.id):this.contentService.publishSection(t.id)).subscribe({next:()=>{t.isPublished=!t.isPublished,this.showMessage(`Section ${e}ed successfully`)},error:a=>{this.showMessage(`Error ${e}ing section: `+a.message)}})}moveSection(t,e){let c=[...this.sections],[a]=c.splice(t,1);c.splice(e,0,a),c.forEach((l,f)=>{l.order=f}),this.sections=c,this.contentService.reorderSections(this.sections).subscribe({next:()=>{this.showMessage("Sections reordered successfully")},error:l=>{this.showMessage("Error reordering sections: "+l.message)}})}moveSubject(t,e){if(!this.selectedSection?.subjects)return;let c=[...this.selectedSection.subjects],[a]=c.splice(t,1);c.splice(e,0,a),c.forEach((l,f)=>{l.order=f}),this.selectedSection.subjects=c,this.contentService.reorderSubjects(this.selectedSection.id,this.selectedSection.subjects).subscribe({next:()=>{this.showMessage("Subjects reordered successfully")},error:l=>{this.showMessage("Error reordering subjects: "+l.message)}})}getContentTypeLabel(t){return"title"in t&&"content"in t?"Theory":"options"in t?"Multiple Choice":"correctAnswer"in t&&typeof t.correctAnswer=="boolean"?"True/False":"Unknown"}getContentPreview(t){return"title"in t?t.title:"No preview available"}showMessage(t){console.log(t),alert(t)}loadUsers(){this.userService.getAllUsers().subscribe({next:t=>{this.users=t},error:t=>{this.showMessage("Error loading users: "+t.message)}})}promoteToAdmin(t){confirm(`Are you sure you want to promote "${t.displayName}" to admin?`)&&this.userService.promoteUser(t.uid,this.authService.getCurrentUser().uid).subscribe({next:()=>{this.showMessage(`User "${t.displayName}" has been promoted to admin`),this.loadUsers()},error:e=>{this.showMessage("Error promoting user to admin: "+e.message)}})}demoteFromAdmin(t){confirm(`Are you sure you want to remove admin privileges from "${t.displayName}"?`)&&this.userService.demoteUser(t.uid,this.authService.getCurrentUser().uid).subscribe({next:()=>{this.showMessage(`Admin privileges removed from "${t.displayName}"`),this.loadUsers()},error:e=>{this.showMessage("Error removing admin privileges: "+e.message)}})}static \u0275fac=function(e){return new(e||s)(j($),j(N),j(U),j(ee))};static \u0275cmp=T({type:s,selectors:[["app-content-admin-panel"]],decls:17,vars:14,consts:[[1,"admin-panel"],[1,"admin-header"],[1,"tab-navigation"],[1,"tab-button",3,"click"],[1,"tab-button",3,"click","disabled"],[1,"tab-content"],[1,"section-management"],[1,"card","create-form"],[1,"card-header"],[1,"card-content"],[3,"ngSubmit","formGroup"],[1,"form-field"],["for","sectionTitle"],["id","sectionTitle","type","text","formControlName","title","placeholder","Enter section title",1,"form-input"],["for","sectionDescription"],["id","sectionDescription","formControlName","description","rows","3","placeholder","Enter section description",1,"form-textarea"],["for","sectionOrder"],["id","sectionOrder","type","number","formControlName","order","placeholder","0",1,"form-input"],[1,"form-field","checkbox-field"],[1,"checkbox-label"],["type","checkbox","formControlName","isPublished",1,"checkbox-input"],[1,"checkbox-custom"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"card","sections-list"],[1,"sections-container"],[1,"section-item",3,"selected"],[1,"empty-state"],[1,"section-item",3,"click"],[1,"section-info"],[1,"section-meta"],[1,"order"],[1,"status"],[1,"subjects-count"],[1,"section-actions"],["title","Toggle Published",1,"btn-icon",3,"click"],[1,"icon"],["title","Delete Section",1,"btn-icon","delete",3,"click"],["title","Move Up",1,"btn-icon",3,"click","disabled"],["title","Move Down",1,"btn-icon",3,"click","disabled"],[1,"subjects-management"],[1,"selected-section-info"],["for","subjectTitle"],["id","subjectTitle","type","text","formControlName","title","placeholder","Enter subject title",1,"form-input"],["for","subjectDescription"],["id","subjectDescription","formControlName","description","rows","3","placeholder","Enter subject description",1,"form-textarea"],["for","subjectOrder"],["id","subjectOrder","type","number","formControlName","order","placeholder","0",1,"form-input"],["for","subjectMinPoints"],["id","subjectMinPoints","type","number","formControlName","minPointsRequired","placeholder","0",1,"form-input"],[1,"card","subjects-list"],[1,"subjects-container"],[1,"subject-item",3,"selected"],[1,"subject-item",3,"click"],[1,"subject-info"],[1,"subject-meta"],[1,"contents-count"],[1,"subject-actions"],["title","Delete Subject",1,"btn-icon","delete",3,"click"],[1,"content-management"],[1,"selected-context"],[1,"card","content-type-selection"],["for","contentType"],["id","contentType",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"card","content-form"],["for","contentOrder"],["id","contentOrder","type","number","formControlName","order","placeholder","Content order",1,"form-input"],["type","button",1,"btn","btn-secondary"],[1,"card","content-list"],["for","theoryTitle"],["id","theoryTitle","type","text","formControlName","title","placeholder","Enter theory title",1,"form-input"],["for","theoryContent"],["id","theoryContent","formControlName","content","rows","6","placeholder","Enter theory content",1,"form-textarea"],["for","mcqTitle"],["id","mcqTitle","type","text","formControlName","title","placeholder","Enter question title",1,"form-input"],["for","mcqQuestion"],["id","mcqQuestion","formControlName","question","rows","3","placeholder","Enter your question",1,"form-textarea"],["for","mcqTime"],["id","mcqTime","type","number","formControlName","timeLimitSeconds","placeholder","e.g. 30",1,"form-input"],["for","mcqPoints"],["id","mcqPoints","type","number","formControlName","maxPoints","placeholder","e.g. 5",1,"form-input"],[1,"options-section"],[1,"option-row"],["type","button",1,"btn","btn-secondary",3,"click"],["for","correctAnswer"],["id","correctAnswer","formControlName","correctAnswer",1,"form-select"],[3,"for"],["type","text","placeholder","Enter option",1,"form-input",3,"id","formControl"],["type","button",1,"btn-icon","delete",3,"click","disabled"],["for","tfTitle"],["id","tfTitle","type","text","formControlName","title","placeholder","Enter question title",1,"form-input"],["for","tfQuestion"],["id","tfQuestion","formControlName","question","rows","3","placeholder","Enter your true/false question",1,"form-textarea"],["for","tfTime"],["id","tfTime","type","number","formControlName","timeLimitSeconds","placeholder","e.g. 15",1,"form-input"],["for","tfPoints"],["id","tfPoints","type","number","formControlName","maxPoints","placeholder","e.g. 2",1,"form-input"],["for","tfAnswer"],["id","tfAnswer","formControlName","correctAnswer",1,"form-select"],[1,"content-items"],[1,"content-item"],[1,"content-info"],[1,"content-type-badge"],[1,"content-order"],[1,"content-actions"],["title","Edit Content",1,"btn-icon",3,"click"],["title","Delete Content",1,"btn-icon","delete",3,"click"],[1,"users-management"],[1,"card","users-list"],[1,"users-table-container"],[1,"users-table"],[1,"user-row"],[1,"user-name"],[1,"user-email"],[1,"user-created"],[1,"user-admin-status"],[1,"admin-badge"],[1,"user-actions"],["title","Promote to Admin",1,"btn","btn-primary","btn-small"],["title","Remove Admin",1,"btn","btn-secondary","btn-small"],["title","Promote to Admin",1,"btn","btn-primary","btn-small",3,"click"],["title","Remove Admin",1,"btn","btn-secondary","btn-small",3,"click"]],template:function(e,c){e&1&&(i(0,"div",0)(1,"header",1)(2,"h1"),o(3,"Admin Panel - Content Management"),n()(),i(4,"nav",2)(5,"button",3),u("click",function(){return c.setActiveTab("sections")}),o(6," Sections "),n(),i(7,"button",4),u("click",function(){return c.setActiveTab("subjects")}),o(8," Subjects "),n(),i(9,"button",4),u("click",function(){return c.setActiveTab("content")}),o(10," Content "),n(),i(11,"button",3),u("click",function(){return c.setActiveTab("users")}),o(12," Users "),n()(),h(13,ce,37,3,"div",5),h(14,le,39,5,"div",5),h(15,xe,37,13,"div",5),h(16,ye,25,1,"div",5),n()),e&2&&(r(5),P("active",c.activeTab==="sections"),r(2),P("active",c.activeTab==="subjects"),C("disabled",!c.selectedSection),r(2),P("active",c.activeTab==="content"),C("disabled",!c.selectedSubject),r(2),P("active",c.activeTab==="users"),r(2),x(c.activeTab==="sections"?13:-1),r(),x(c.activeTab==="subjects"&&c.selectedSection?14:-1),r(),x(c.activeTab==="content"&&c.selectedSubject?15:-1),r(),x(c.activeTab==="users"?16:-1))},dependencies:[I,te,R,X,Z,L,W,z,K,B,Q,G,ne,Y,H,J,D],styles:[".admin-panel[_ngcontent-%COMP%]{padding:1.25rem;max-width:1200px;margin:0 auto;background-color:var(--dark-blue);color:var(--white);border-radius:8px}.admin-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:var(--white);margin-bottom:2rem;text-align:center;font-size:2rem}.tab-navigation[_ngcontent-%COMP%]{display:flex;border-bottom:2px solid var(--charcoal-blue);margin-bottom:1.25rem;gap:.25rem}.tab-button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:var(--charcoal-blue);color:var(--white);cursor:pointer;border-radius:8px 8px 0 0;font-size:1rem;font-weight:600;transition:all .3s ease}.tab-button[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--electric-blue);color:var(--dark-blue)}.tab-button.active[_ngcontent-%COMP%]{background:var(--electric-blue);color:var(--dark-blue);border-bottom:2px solid var(--electric-blue)}.tab-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.tab-content[_ngcontent-%COMP%]{background-color:var(--dark-blue);padding:1.25rem;border-radius:0 0 8px 8px}.card[_ngcontent-%COMP%]{background-color:var(--charcoal-blue);border-radius:8px;margin-bottom:1.25rem;box-shadow:0 4px 6px #0000004d}.card-header[_ngcontent-%COMP%]{background-color:var(--electric-blue);color:var(--dark-blue);padding:1rem 1.25rem;border-radius:8px 8px 0 0;font-weight:700}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.card-content[_ngcontent-%COMP%]{padding:1.25rem 3rem 1.25rem 1.25rem}.form-field[_ngcontent-%COMP%]{margin-bottom:1rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--white);font-weight:600;margin-bottom:.5rem;font-size:.9rem}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid var(--electric-blue);border-radius:4px;background-color:var(--dark-blue);color:var(--white);font-size:1rem;transition:border-color .3s ease}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--electric-blue);box-shadow:0 0 0 2px #4a90e233}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:5rem}.code-segment[_ngcontent-%COMP%]{padding-right:3rem!important}.checkbox-field[_ngcontent-%COMP%]{display:flex;align-items:center}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-weight:400}.checkbox-input[_ngcontent-%COMP%]{margin-right:.5rem;width:1rem;height:1rem}.btn[_ngcontent-%COMP%]{padding:.625rem 1.25rem;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:all .3s ease;text-decoration:none;display:inline-block}.btn-primary[_ngcontent-%COMP%]{background-color:var(--electric-blue);color:var(--dark-blue)}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#5a9bd4;transform:translateY(-1px)}.btn-secondary[_ngcontent-%COMP%]{background-color:var(--charcoal-blue);color:var(--white);border:1px solid var(--electric-blue)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--electric-blue);color:var(--dark-blue)}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:.5rem;border-radius:4px;color:var(--white);transition:all .3s ease;display:flex;align-items:center;justify-content:center}.btn-icon[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--electric-blue);color:var(--dark-blue)}.btn-icon.delete[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--failed-red);color:var(--white)}.btn-icon.delete[_ngcontent-%COMP%]{margin-left:1rem}.btn-icon[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-icon[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.2rem}.form-actions[_ngcontent-%COMP%]{margin-top:1.25rem;display:flex;gap:.625rem}.section-item[_ngcontent-%COMP%], .subject-item[_ngcontent-%COMP%], .content-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;margin-bottom:.75rem;border:1px solid var(--electric-blue);border-radius:8px;cursor:pointer;transition:all .3s ease;background:var(--charcoal-blue)}.section-item[_ngcontent-%COMP%]:hover, .subject-item[_ngcontent-%COMP%]:hover, .content-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #4a90e233;border-color:var(--electric-blue);transform:translateY(-2px)}.section-item.selected[_ngcontent-%COMP%], .subject-item.selected[_ngcontent-%COMP%]{border-color:var(--electric-blue);background-color:#4a90e21a;box-shadow:0 0 0 2px #4a90e24d}.section-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .subject-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .content-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--white);font-size:1.1rem}.section-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .subject-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .75rem;color:var(--white);opacity:.8;line-height:1.4}.section-meta[_ngcontent-%COMP%], .subject-meta[_ngcontent-%COMP%]{display:flex;gap:1.25rem;align-items:center;font-size:.875rem}.section-meta[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%], .subject-meta[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%], .content-order[_ngcontent-%COMP%]{background:var(--dark-blue);padding:.25rem .5rem;border-radius:4px;color:var(--white);font-size:.8rem}.section-meta[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:4px;color:var(--white);background:var(--failed-red);font-size:.8rem}.section-meta[_ngcontent-%COMP%]   .status.published[_ngcontent-%COMP%]{background:var(--success-green)}.section-meta[_ngcontent-%COMP%]   .subjects-count[_ngcontent-%COMP%], .subject-meta[_ngcontent-%COMP%]   .contents-count[_ngcontent-%COMP%]{color:var(--white);opacity:.8}.section-actions[_ngcontent-%COMP%], .subject-actions[_ngcontent-%COMP%], .content-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.options-section[_ngcontent-%COMP%], .test-cases-section[_ngcontent-%COMP%], .hints-section[_ngcontent-%COMP%], .code-segment[_ngcontent-%COMP%]{margin:1.25rem 0;padding:1rem;border:1px solid var(--electric-blue);border-radius:8px;background:#4a90e21a}.options-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .test-cases-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .hints-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .code-segment[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--white);font-size:1rem}.option-row[_ngcontent-%COMP%], .hint-row[_ngcontent-%COMP%], .test-case-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:.625rem;margin-bottom:.75rem}.test-case-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:.625rem;align-items:flex-end}.option-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%], .hint-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{flex:1;margin-bottom:0}.test-case-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-bottom:0}.content-type-badge[_ngcontent-%COMP%]{background:var(--electric-blue);color:var(--dark-blue);padding:.25rem .5rem;border-radius:4px;font-size:.75rem;font-weight:600;margin-right:.75rem}.content-info[_ngcontent-%COMP%]{display:flex;align-items:center;flex:1}.content-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;flex:1}.empty-state[_ngcontent-%COMP%]{text-align:center;color:var(--white);opacity:.6;font-style:italic;padding:2.5rem;background:#4a90e20d;border-radius:8px;border:1px dashed var(--electric-blue)}.selected-section-info[_ngcontent-%COMP%], .selected-context[_ngcontent-%COMP%]{margin-bottom:1.25rem;padding:1rem;background:#4a90e21a;border-radius:8px;border-left:4px solid var(--electric-blue)}.selected-section-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .selected-context[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--electric-blue);margin:0 0 .5rem;font-size:1.4rem}.selected-context[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--white);opacity:.8;margin:0}@media (max-width: 768px){.admin-panel[_ngcontent-%COMP%]{padding:1rem;margin:.625rem}.tab-navigation[_ngcontent-%COMP%]{flex-direction:column}.tab-button[_ngcontent-%COMP%]{border-radius:4px;margin-bottom:.25rem}.section-item[_ngcontent-%COMP%], .subject-item[_ngcontent-%COMP%], .content-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.section-actions[_ngcontent-%COMP%], .subject-actions[_ngcontent-%COMP%], .content-actions[_ngcontent-%COMP%]{align-self:flex-end}.test-case-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.625rem}.option-row[_ngcontent-%COMP%], .hint-row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.users-table-container[_ngcontent-%COMP%]{overflow-x:auto}.users-table[_ngcontent-%COMP%]{min-width:600px}}.users-management[_ngcontent-%COMP%]{width:100%}.users-table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:1rem}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background-color:var(--charcoal-blue);border-radius:8px;overflow:hidden}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid var(--electric-blue)}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--electric-blue);color:var(--dark-blue);font-weight:600;font-size:.9rem;text-transform:uppercase;letter-spacing:.5px}.users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--white);vertical-align:middle}.user-row[_ngcontent-%COMP%]:hover{background-color:#4a90e21a}.user-name[_ngcontent-%COMP%]{font-weight:600}.user-email[_ngcontent-%COMP%]{color:var(--white);opacity:.8}.user-created[_ngcontent-%COMP%]{color:var(--white);opacity:.7;font-size:.9rem}.user-admin-status[_ngcontent-%COMP%]{text-align:center}.admin-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.admin-badge.admin[_ngcontent-%COMP%]{background-color:var(--success-green);color:var(--white)}.admin-badge.regular[_ngcontent-%COMP%]{background-color:var(--charcoal-blue);color:var(--white);border:1px solid var(--electric-blue)}.user-actions[_ngcontent-%COMP%]{text-align:center}.btn-small[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem}"]})};export{ie as ContentAdminPanelComponent};
